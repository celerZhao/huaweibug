Date.prototype.Format=function(fmt){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};if(/(y+)/.test(fmt)){fmt=fmt.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(fmt)){fmt=fmt.replace(RegExp.$1,(RegExp.$1.length==1)?(o[k]):(("00"+o[k]).substr((""+o[k]).length)))}}return fmt};var tjArr=localStorage.getItem("jsArr")?localStorage.getItem("jsArr"):"[{}]";var second=0,type=Env.type,versionEnv="",terminalType="";function HashMap(){this.map={}}HashMap.prototype={put:function(key,value){this.map[key]=value},get:function(key){if(this.map.hasOwnProperty(key)){return this.map[key]}return null},remove:function(key){if(this.map.hasOwnProperty(key)){return delete this.map[key]}return false},removeAll:function(){this.map={}},keySet:function(){var _keys=[];for(var i in this.map){_keys.push(i)}return _keys}};Appcount={getReferrer:function(){var referrer="";try{referrer=window.top.document.referrer}catch(e){if(window.parent){try{referrer=window.parent.document.referrer}catch(e2){referrer=""}}}if(referrer===""){referrer=document.referrer}return referrer},getId:function(ele,count){var id=ele.target.id;if(id==undefined||null==id||""==id||!Appcount.pmContains(id)){id=Appcount.getParentId(ele.target.parentNode,0)}return id},pmContains:function(id){if(Env.type=="pc"){if(id.indexOf("pc_")!=-1){return true}return false}else{if(id.indexOf("activity_")!=-1||id.indexOf("m_")!=-1||id.indexOf("product_")!=-1||id.indexOf("my_")!=-1||id.indexOf("driver_")!=-1){return true}return false}},getParentId:function(ele,count){if(undefined==count){var count=0}else{count++}var nodeId=ele.id;if(undefined==nodeId||null==nodeId||""==nodeId||!Appcount.pmContains(nodeId)){if(count<10){nodeId=Appcount.getParentId(ele.parentNode,count)}else{return"not_found_id"}}return nodeId},getWapType:function(){var browerType=navigator.userAgent;if(browerType.indexOf("Wechat")!=-1||browerType.indexOf("MicroMessenger")!=-1){return"WX"}else{if(browerType.indexOf("QQ/")!=-1){return"QQ"}else{return"BR"}}},getBrowerType:function(){var brower="";if(Env.type=="pc"){brower=BrowserType()}else{brower=Appcount.getWapType()}return brower},clickFun:function(evt){var pcode=Appcount.getCookie("market");var memberId=Appcount.getCookie("S[MEMBER]");var phone=Appcount.getCookie("UNAME");if(null==memberId||undefined==memberId){memberId=""}if(null==phone||undefined==phone){phone=""}var eventId=Appcount.getId(evt);var eventTime=new Date().Format("yyyy-MM-dd hh:mm:ss");var versionEnv=Env.version;var browerType=Appcount.getBrowerType();var data="&eventId="+eventId+"&eventTime="+eventTime+"&eventCount=1"+"&versionEnv="+versionEnv+"&terminalType="+Env.type+"&browerType="+browerType+"&pcode="+pcode+"&memberId="+memberId+"&phone="+phone;Appcount.sendData(data,Env.url+"/pmlog/click")},delCookie:function(name){var exp=new Date();exp.setTime(exp.getTime()-1);document.cookie=name+"="+""+";expires="+exp.toGMTString()+";path=/"},setCookie:function(c_name,value,expiredays){var exdate=new Date();exdate.setDate(exdate.getDate()+expiredays);document.cookie=c_name+"="+escape(value)+((expiredays==null)?"":";expires="+exdate.toGMTString())+";path=/"},getCookie:function(cname){var name=cname+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i].trim();if(c.indexOf(name)==0){return unescape(c.substring(name.length,c.length))}}return""},getReqCookie:function(cname){var ca=document.cookie.split(";");var reqMap=new HashMap();for(var i=0;i<ca.length;i++){var c=ca[i].trim();if(c.indexOf(cname)!=-1){var arr=c.split("=");var keyStart=arr[0]+"=";reqMap.put(arr[0],unescape(c.substring(keyStart.length,c.length)))}}return reqMap},sendData:function(data,url){var result="0";var curTime=(new Date()).getTime();var endTime=0;var req=url+"?"+data;Appcount.onClickSaveOrSend(req)},sendPageData:function(data,url){var url=url+"?"+data+"&callback=?";var urls=Appcount.getCookie("req");if(undefined!=url&&null!=urls&&""!=urls){urls+=url+";"}else{urls+=url}},IsPC:function(){var userAgentInfo=navigator.userAgent;var Agents=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod");var flag=true;for(var v=0;v<Agents.length;v++){if(userAgentInfo.indexOf(Agents[v])>0){flag=false;break}}return flag},addWapListener:function(){setTimeout(function(){for(var i=0;i<Env.btns.length;i++){var ele=document.getElementById(Env.btns[i]);if(null!=ele){ele.addEventListener("click",Appcount.clickFun,false)}}var list=document.getElementsByTagName("a");for(var i=0;i<list.length;i++){var tag=list[i].attributes["id"];if(null!=tag&undefined!=tag){var id=tag.value;var type=Env.type;if(Env.btns.indexOf(id)==-1){if(Appcount.pmContains(id)){list[i].addEventListener("click",Appcount.clickFun,false)}}}}var list=document.getElementsByTagName("div");for(var i=0;i<list.length;i++){var tag=list[i].attributes["id"];if(null!=tag&undefined!=tag){var id=tag.value;
var type=Env.type;if(Env.btns.indexOf(id)==-1){if(Appcount.pmContains(id)){list[i].addEventListener("click",Appcount.clickFun,false)}}}}var list=document.getElementsByTagName("button");for(var i=0;i<list.length;i++){var tag=list[i].attributes["id"];if(null!=tag&undefined!=tag){var id=tag.value;var type=Env.type;if(Env.btns.indexOf(id)==-1){if(Appcount.pmContains(id)){list[i].addEventListener("click",Appcount.clickFun,false)}}}}var list=document.getElementsByTagName("input");for(var i=0;i<list.length;i++){var tag=list[i].attributes["id"];if(null!=tag&undefined!=tag){var id=tag.value;var type=Env.type;if(Env.btns.indexOf(id)==-1){if(Appcount.pmContains(id)){list[i].addEventListener("click",Appcount.clickFun,false)}}}}var list=document.getElementsByTagName("li");for(var i=0;i<list.length;i++){var tag=list[i].attributes["id"];if(null!=tag&undefined!=tag){var id=tag.value;var type=Env.type;if(Env.btns.indexOf(id)==-1){if(Appcount.pmContains(id)){list[i].addEventListener("click",Appcount.clickFun,false)}}}}},500)},addPcListener:function(){setTimeout(function(){for(var i=0;i<Env.btns.length;i++){var ele=document.getElementById(Env.btns[i]);if(null!=ele){ele.addEventListener("click",Appcount.clickFun,false)}}var list=document.getElementsByTagName("a");for(var i=0;i<list.length;i++){var tag=list[i].attributes["id"];if(null!=tag&undefined!=tag){var id=tag.value;var type=Env.type;if(Env.btns.indexOf(id)==-1){if(Appcount.pmContains(id)){list[i].addEventListener("click",Appcount.clickFun,false)}}}}var list=document.getElementsByTagName("div");for(var i=0;i<list.length;i++){var tag=list[i].attributes["id"];if(null!=tag&undefined!=tag){var id=tag.value;var type=Env.type;if(Env.btns.indexOf(id)==-1){if(Appcount.pmContains(id)){list[i].addEventListener("click",Appcount.clickFun,false)}}}}var list=document.getElementsByTagName("button");for(var i=0;i<list.length;i++){var tag=list[i].attributes["id"];if(null!=tag&undefined!=tag){var id=tag.value;var type=Env.type;if(Env.btns.indexOf(id)==-1){if(Appcount.pmContains(id)){list[i].addEventListener("click",Appcount.clickFun,false)}}}}var list=document.getElementsByTagName("input");for(var i=0;i<list.length;i++){var tag=list[i].attributes["id"];if(null!=tag&undefined!=tag){var id=tag.value;var type=Env.type;if(Env.btns.indexOf(id)==-1){if(Appcount.pmContains(id)){list[i].addEventListener("click",Appcount.clickFun,false)}}}}var list=document.getElementsByTagName("li");for(var i=0;i<list.length;i++){var tag=list[i].attributes["id"];if(null!=tag&undefined!=tag){var id=tag.value;var type=Env.type;if(Env.btns.indexOf(id)==-1){if(Appcount.pmContains(id)){list[i].addEventListener("click",Appcount.clickFun,false)}}}}var list=document.getElementsByTagName("span");for(var i=0;i<list.length;i++){var tag=list[i].attributes["id"];if(null!=tag&undefined!=tag){var id=tag.value;var type=Env.type;if(Env.btns.indexOf(id)==-1){if(Appcount.pmContains(id)){list[i].addEventListener("click",Appcount.clickFun,false)}}}}var list=document.getElementsByTagName("label");for(var i=0;i<list.length;i++){var tag=list[i].attributes["id"];if(null!=tag&undefined!=tag){var id=tag.value;var type=Env.type;if(Env.btns.indexOf(id)==-1){if(Appcount.pmContains(id)){list[i].addEventListener("click",Appcount.clickFun,false)}}}}},500)},addListener:function(){if(Env.type=="pc"){Appcount.addPcListener()}else{Appcount.addWapListener()}},parseUrl:function(url){var urls=url.split("?");var wlp=urls[1];this.host=urls[0];var match=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(.*)?$/;this.host=match.exec(url)[3];if(wlp==undefined){return}var wincs=wlp.split("&");for(var i=0;i<wincs.length;i++){var tur=wincs[i].split("=");eval("this."+tur[0]+'="'+tur[1]+'";')}},sendReq:function(url){var n="log_"+(new Date()).getTime();var c=window[n]=new Image();c.onload=(c.onerror=function(){window[n]=null});c.src=url},onClickSaveOrSend:function(url){if(Env.type=="pc"){Appcount.sendReq(url)}else{var req=Appcount.getCookie("req");if(undefined!=req&&""!=req&&null!=req){if(req.indexOf("|")!=-1){var arrs=req.split("|");if(arrs.length<5&&arrs.indexOf(url)==-1){req+="|"+url;Appcount.setCookie("req",req,30)}}else{req+="|"+url;Appcount.setCookie("req",req,30)}}else{Appcount.setCookie("req",url,30)}}},sendByCookie:function(){setInterval(function(){Appcount.sendNow()},5000)},sendNow:function(){var req=Appcount.getCookie("req");if(undefined!=req&&null!=req&&""!=req){Appcount.delCookie("req");if(req.indexOf("|")!=-1){var splits=req.split("|");for(var i=0;i<splits.length;i++){Appcount.sendReq(splits[i])}}else{Appcount.sendReq(req)}}},init:function(){if(Env.type=="wap"){Appcount.sendNow();Appcount.sendByCookie()}var versionEnv=BrowserType();var refer=Appcount.getReferrer();var pcode="";var url=location.href;if(url.indexOf("pcode")!=-1){var urls=new Appcount.parseUrl(url);pcode=urls.pcode;Appcount.setCookie("market",pcode,null)}}};Appcount.init();